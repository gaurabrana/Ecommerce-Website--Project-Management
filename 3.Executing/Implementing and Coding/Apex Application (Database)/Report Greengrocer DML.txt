---Daily Orders
SELECT M.ORDERID,
P.NAME AS PRODUCT_NAME,
       P.PRODUCT_TYPE,                     
       M.PRICE,
       M.QUANTITY,
       M.TOTALPRICE
FROM ORDERDETAILS M, ORDERS O, PRODUCT P, USERS U, SHOP S, PAYMENT PS WHERE P.PRODUCTID = M.PRODUCTID 
AND M.ORDERID = O.ORDERID 
AND U.USERID = P.USERID
AND U.USERID = S.USERID
AND PS.ORDERID = O.ORDERID
AND S.TRADERTYPE = 'Greengrocer'
AND TRUNC(PS.PAIDDATE) = TRUNC(SYSDATE);

---WEEKLY FINANCES
SELECT PRODUCT.NAME, SUM(ORDERDETAILS.QUANTITY) AS UNITS_SOLD,
ORDERDETAILS.PRICE, ORDERDETAILS.PRICE*SUM(ORDERDETAILS.QUANTITY) AS INCOME
FROM ORDERDETAILS, ORDERS, PRODUCT, USERS, PAYMENT, SHOP
WHERE PAYMENT.ORDERID= ORDERDETAILS.ORDERID
AND ORDERS.ORDERID = ORDERDETAILS.ORDERID
AND ORDERDETAILS.PRODUCTID = PRODUCT.PRODUCTID
AND USERS.USERID = PRODUCT.USERID
AND SHOP.USERID = USERS.USERID
AND SHOP.TRADERTYPE = 'Greengrocer'
AND to_char(TO_DATE(TO_CHAR(PAIDDATE,'MON/DD/YYYY') ||'00:00:08','MON/DD/YYYY SS:MI:HH12 PM'), 'MM/DD/YYYY') > trunc(sysdate) - 7
GROUP BY PRODUCT.NAME, PRODUCT.PRICE,ORDERDETAILS.PRICE
ORDER BY PRODUCT.PRICE*SUM(ORDERDETAILS.QUANTITY) DESC;

---MONTHLY SALES
SELECT PRODUCT.NAME, SUM(ORDERDETAILS.QUANTITY) AS UNITS_SOLD,
ORDERDETAILS.PRICE, ORDERDETAILS.PRICE*SUM(ORDERDETAILS.QUANTITY) AS INCOME
FROM ORDERDETAILS, ORDERS, PRODUCT, USERS, PAYMENT, SHOP
WHERE PAYMENT.ORDERID= ORDERDETAILS.ORDERID
AND ORDERS.ORDERID = ORDERDETAILS.ORDERID
AND ORDERDETAILS.PRODUCTID = PRODUCT.PRODUCTID
AND USERS.USERID = PRODUCT.USERID
AND SHOP.USERID = USERS.USERID
AND SHOP.TRADERTYPE = 'Greengrocer'
AND to_char(TO_DATE(TO_CHAR(PAIDDATE,'MON/DD/YYYY') ||'00:00:08','MON/DD/YYYY SS:MI:HH12 PM'), 'MM/DD/YYYY') > trunc(sysdate) - 30
GROUP BY PRODUCT.NAME, PRODUCT.PRICE,ORDERDETAILS.PRICE
ORDER BY PRODUCT.PRICE*SUM(ORDERDETAILS.QUANTITY) DESC;