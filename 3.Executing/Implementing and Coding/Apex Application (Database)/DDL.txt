---DROP
DROP TABLE PAYMENT;
DROP TABLE ORDERDETAILS;
DROP TABLE ORDERS;
DROP TABLE COLLECTIONSLOT;
DROP TABLE REVIEW;
DROP TABLE PRODUCT_CART;
DROP TABLE PRODUCT;
DROP TABLE DISCOUNT;
DROP TABLE SHOP;
DROP TABLE CART;
DROP TABLE USERS;

--CREATE
CREATE TABLE USERS(	
USERID NUMBER(10) PRIMARY KEY,
TYPES NUMBER(1) NOT NULL,
NAME VARCHAR2(40) NOT NULL,
ADDRESS VARCHAR2(40) NOT NULL,
AGE NUMBER(2) NOT NULL,
GENDER VARCHAR2(6) NOT NULL,
EMAIL VARCHAR2(40) NOT NULL UNIQUE, 
PASSWORD VARCHAR2(50) NOT NULL,    
VERIFICATION_KEY VARCHAR2(50) UNIQUE,    
VERIFIED VARCHAR2(3) NOT NULL,
IMAGE_NAME VARCHAR2(50),    
JOINED_DATE DATE NOT NULL       
);
CREATE TABLE CART(
CARTID NUMBER(10) PRIMARY KEY,
USERID NUMBER(10) REFERENCES USERS(USERID)
);
CREATE TABLE SHOP(
SHOPID Number(5) PRIMARY KEY,
TRADERTYPE VARCHAR2(15) NOT NULL UNIQUE,
USERID NUMBER(10) REFERENCES USERS(USERID)
);
CREATE TABLE DISCOUNT(
DISCOUNTID NUMBER(10) PRIMARY KEY,
AMOUNT NUMBER(10),
USERID NUMBER(10) REFERENCES USERS(USERID)    
);
CREATE TABLE PRODUCT(
PRODUCTID NUMBER(10) PRIMARY KEY,
NAME VARCHAR2(255) NOT NULL,
DESCRIPTION VARCHAR2(1000) NOT NULL,
PRODUCT_TYPE VARCHAR2(255),    
PRICE NUMBER(10,2) NOT NULL,
QTYINSTOCK NUMBER(10) NOT NULL,
SHOPID NUMBER(5) REFERENCES SHOP(SHOPID),
USERID NUMBER(10) REFERENCES USERS(USERID),
DISCOUNTID NUMBER(10) REFERENCES DISCOUNT(DISCOUNTID),
IMAGE_NAME VARCHAR2(255)    
);
CREATE TABLE PRODUCT_CART(
PRODUCTID NUMBER(10) REFERENCES PRODUCT(PRODUCTID),
CARTID NUMBER(10) REFERENCES CART(CARTID),
QUANTITY NUMBER (10),
PRIMARY KEY(PRODUCTID, CARTID)
);

CREATE TABLE REVIEW(
REVIEWID NUMBER(10),
DESCRIPTION VARCHAR2(1000),
PRODUCTID NUMBER(10) REFERENCES PRODUCT(PRODUCTID),
USERID NUMBER(10) REFERENCES USERS(USERID),
RATE NUMBER(1)
);

CREATE TABLE COLLECTIONSLOT(
    SLOTID NUMBER(10) PRIMARY KEY,
    DAY VARCHAR2(10),
    COLLECTIONTIME VARCHAR(20),
    WEEK_COUNT VARCHAR2(20),
    NUMBER_OF_ORDERS NUMBER(10)
);

CREATE TABLE ORDERS(
ORDERID NUMBER(10) PRIMARY KEY,
    NAME VARCHAR2(100),
    PHONENUMBER NUMBER(20),
    EMAIL VARCHAR2(50),
    TOWN VARCHAR2(20),
    ADDRESS VARCHAR2(50),
    ZIPCODE NUMBER(10),
    ORDERDATE VARCHAR2(30),
    CARTID NUMBER(10) REFERENCES CART(CARTID),
    SLOTID NUMBER(10) REFERENCES COLLECTIONSLOT(SLOTID),
    PURCHASED VARCHAR2(10)
);

CREATE TABLE ORDERDETAILS(
PRODUCTID NUMBER(10) REFERENCES PRODUCT(PRODUCTID),
    ORDERID NUMBER(10) REFERENCES ORDERS(ORDERID),
    QUANTITY NUMBER(10),
    PRICE NUMBER(10,2),
    TOTALPRICE NUMBER(10,2),
    PRIMARY KEY(PRODUCTID,ORDERID)   
);

CREATE TABLE PAYMENT(
    PAYMENTID NUMBER(10) PRIMARY KEY,    
    USERID NUMBER(10) REFERENCES USERS(USERID),
    ORDERID NUMBER(10) REFERENCES ORDERS(ORDERID),
    TOTALPRICE NUMBER(10,2),
    PAIDDATE TIMESTAMP(1)
);

--ALTER
ALTER TABLE  "SHOP" ADD FOREIGN KEY ("USERID")
	  REFERENCES  "USERS" ("USERID") ENABLE;

ALTER TABLE  "REVIEW" ADD FOREIGN KEY ("PRODUCTID")
	  REFERENCES  "PRODUCT" ("PRODUCTID") ENABLE;

ALTER TABLE  "REVIEW" ADD FOREIGN KEY ("USERID")
	  REFERENCES  "USERS" ("USERID") ENABLE;

ALTER TABLE  "PRODUCT_CART" ADD FOREIGN KEY ("PRODUCTID")
	  REFERENCES  "PRODUCT" ("PRODUCTID") ENABLE;

ALTER TABLE  "PRODUCT_CART" ADD FOREIGN KEY ("CARTID")
	  REFERENCES  "CART" ("CARTID") ENABLE;

ALTER TABLE  "PRODUCT" ADD FOREIGN KEY ("SHOPID")
	  REFERENCES  "SHOP" ("SHOPID") ENABLE;

ALTER TABLE  "PRODUCT" ADD FOREIGN KEY ("USERID")
	  REFERENCES  "USERS" ("USERID") ENABLE;

ALTER TABLE  "PRODUCT" ADD FOREIGN KEY ("DISCOUNTID")
	  REFERENCES  "DISCOUNT" ("DISCOUNTID") ENABLE;


ALTER TABLE  "PAYMENT" ADD FOREIGN KEY ("USERID")
	  REFERENCES  "USERS" ("USERID") ENABLE;

ALTER TABLE  "PAYMENT" ADD FOREIGN KEY ("ORDERID")
	  REFERENCES  "ORDERS" ("ORDERID") ENABLE;

ALTER TABLE  "ORDERS" ADD FOREIGN KEY ("CARTID")
	  REFERENCES  "CART" ("CARTID") ENABLE;

ALTER TABLE  "ORDERS" ADD FOREIGN KEY ("SLOTID")
	  REFERENCES  "COLLECTIONSLOT" ("SLOTID") ENABLE;

ALTER TABLE  "ORDERDETAILS" ADD FOREIGN KEY ("PRODUCTID")
	  REFERENCES  "PRODUCT" ("PRODUCTID") ENABLE;

ALTER TABLE  "ORDERDETAILS" ADD FOREIGN KEY ("ORDERID")
	  REFERENCES  "ORDERS" ("ORDERID") ENABLE;

ALTER TABLE  "DISCOUNT" ADD FOREIGN KEY ("USERID")
	  REFERENCES  "USERS" ("USERID") ENABLE;

ALTER TABLE  "CART" ADD FOREIGN KEY ("USERID")
	  REFERENCES  "USERS" ("USERID") ENABLE;
